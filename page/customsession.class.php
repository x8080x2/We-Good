<?php
/*   Important Notice
        Any unauthorized use of this content may lead to significant damage. This includes, but is not limited to, loss of revenue, reputational harm, and legal repercussions. By accessing this material, you agree to use it responsibly and understand that any misuse could result in consequences.
        
        Please respect the rights associated with this work.
        */
 class CustomSession { private $F82cb; private $c6b60; private $Da5fc = 3600; private $Eaa29; private $b1dbb = array(); private $ec875; public function __construct($Def0b = null) { goto B47bd; e9f76: $this->startSession(); goto C106b; e8c42: $this->generateClientFingerprint(); goto e9f76; B47bd: $this->Eaa29 = $Def0b ?: dirname(__FILE__) . "\x2f\163\145\x73\x73\x69\157\156\x73\56\x64\142"; goto A97f7; A97f7: $this->initDatabase(); goto e8c42; C106b: } private function initDatabase() { try { goto B55bc; f2ef3: $this->F82cb->exec("\x43\x52\105\101\124\105\x20\x49\116\104\x45\130\40\111\106\40\116\117\124\x20\x45\130\x49\x53\x54\123\40\x69\144\170\x5f\x73\145\x73\163\151\157\156\137\x69\144\40\117\x4e\x20\163\x65\x73\x73\x69\x6f\156\163\x28\x73\x65\163\163\x69\157\156\x5f\151\144\51"); goto E7aa4; f4c78: $this->F82cb->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); goto Dc353; E7aa4: $this->F82cb->exec("\x43\x52\105\101\x54\105\40\111\x4e\104\x45\130\40\x49\106\40\116\117\124\40\x45\130\x49\x53\x54\123\40\151\144\x78\137\146\151\156\x67\x65\x72\160\162\151\156\x74\40\117\x4e\x20\x73\x65\x73\x73\x69\157\x6e\163\x28\x63\154\151\145\156\164\x5f\146\151\x6e\x67\145\x72\x70\x72\x69\x6e\x74\51"); goto Ee89a; Dc353: $this->F82cb->exec("\12\40\40\x20\x20\40\x20\x20\40\40\x20\40\x20\40\40\40\x20\x43\122\x45\x41\x54\x45\40\124\x41\x42\114\105\40\111\x46\x20\x4e\x4f\124\40\105\130\x49\x53\124\123\x20\x73\x65\163\x73\x69\x6f\x6e\163\x20\50\xa\40\x20\x20\40\40\40\40\x20\40\x20\x20\40\x20\40\40\x20\40\x20\x20\x20\x69\x64\40\x49\116\x54\105\x47\x45\x52\40\120\122\111\115\x41\122\x59\x20\x4b\105\131\40\x41\x55\x54\117\x49\x4e\103\x52\x45\115\105\x4e\x54\54\12\x20\x20\x20\40\x20\x20\40\x20\40\x20\x20\40\x20\40\40\x20\x20\x20\40\40\x73\145\x73\x73\151\x6f\156\137\x69\x64\40\124\x45\x58\124\40\125\x4e\x49\x51\125\105\x20\x4e\117\124\x20\x4e\x55\114\114\x2c\xa\40\40\40\40\x20\40\40\x20\x20\x20\40\40\40\40\x20\x20\x20\x20\x20\40\143\154\151\x65\156\x74\x5f\146\151\156\147\x65\x72\160\162\x69\x6e\164\x20\124\x45\x58\x54\x20\x4e\117\x54\x20\116\x55\114\x4c\x2c\xa\40\40\x20\40\40\x20\40\x20\x20\x20\40\x20\40\x20\x20\40\40\40\x20\40\x69\160\x5f\x61\144\144\x72\145\163\163\x20\124\105\130\x54\40\x4e\117\x54\40\x4e\x55\x4c\x4c\54\12\40\x20\x20\40\40\x20\x20\40\40\40\40\x20\40\x20\x20\40\40\40\40\x20\x75\163\145\162\x5f\x61\x67\145\156\164\40\x54\x45\x58\x54\40\116\x4f\124\x20\x4e\125\x4c\114\54\xa\x20\x20\x20\x20\x20\40\x20\40\x20\x20\x20\x20\x20\40\x20\x20\x20\x20\40\40\163\x65\x73\163\151\x6f\x6e\x5f\x64\141\164\x61\x20\124\105\130\x54\x20\x44\x45\106\x41\x55\x4c\124\40\x27\173\175\47\54\xa\x20\x20\x20\40\40\40\40\40\40\x20\40\x20\x20\40\40\x20\x20\40\x20\40\x63\162\145\x61\164\145\x64\x5f\x61\164\40\104\101\124\x45\x54\111\x4d\105\40\x44\x45\x46\x41\125\114\124\x20\x43\x55\x52\x52\105\116\124\137\124\111\x4d\x45\123\124\101\x4d\x50\x2c\12\40\40\x20\40\40\x20\40\40\40\40\x20\40\x20\x20\40\40\40\40\40\40\x75\160\x64\x61\164\145\x64\x5f\x61\x74\x20\x44\x41\x54\x45\124\111\x4d\105\40\104\x45\x46\101\125\x4c\x54\x20\x43\125\x52\122\105\116\124\137\x54\111\115\105\x53\x54\x41\115\x50\x2c\12\40\x20\x20\x20\40\40\x20\40\x20\40\40\40\40\40\x20\40\40\40\40\x20\x65\x78\160\x69\x72\x65\x73\137\x61\164\40\x44\101\x54\105\124\111\x4d\x45\40\x4e\117\124\x20\116\x55\x4c\114\xa\40\x20\40\40\x20\40\x20\x20\x20\40\40\x20\x20\40\x20\x20\x29\xa\x20\40\40\x20\40\x20\40\x20\40\x20\x20\40"); goto f2ef3; B55bc: $this->F82cb = new PDO("\x73\161\x6c\151\x74\x65\72" . $this->Eaa29); goto f4c78; Ee89a: } catch (PDOException $fabfb) { throw new Exception("\x44\x61\x74\x61\142\141\163\x65\x20\x69\x6e\151\x74\x69\x61\154\151\x7a\141\164\x69\x6f\x6e\x20\146\x61\x69\x6c\x65\144\x3a\x20" . $fabfb->getMessage()); } } private function generateClientFingerprint() { goto b60a4; dce96: $afb2b = $_SERVER["\110\124\124\120\x5f\101\x43\103\105\120\124\137\114\x41\x4e\107\x55\101\107\x45"] ?? ''; goto ede93; f940e: $c84e9 = $_SERVER["\x48\124\x54\120\137\x55\x53\x45\122\137\x41\107\105\x4e\x54"] ?? "\165\156\153\156\x6f\x77\156"; goto dce96; ede93: $Ccae5 = $_SERVER["\x48\x54\124\120\137\x41\103\x43\105\x50\x54\x5f\105\116\103\117\x44\111\x4e\107"] ?? ''; goto c59e6; b60a4: $e3f5a = $this->getClientIP(); goto f940e; c59e6: $this->ec875 = hash("\x73\x68\141\x32\65\x36", $e3f5a . "\174" . $c84e9 . "\x7c" . $afb2b . "\174" . $Ccae5); goto B000a; B000a: } private function getClientIP() { goto C58c6; C58c6: $e9477 = ["\x48\x54\x54\x50\x5f\x43\x46\137\x43\117\x4e\116\x45\x43\x54\x49\116\107\137\111\x50", "\x48\124\124\x50\137\130\137\106\117\122\127\101\122\104\x45\104\137\106\x4f\122", "\110\124\x54\x50\x5f\x58\137\106\117\x52\127\101\x52\x44\105\104", "\110\x54\124\x50\x5f\x58\137\x43\114\125\x53\124\x45\x52\x5f\x43\114\111\105\116\124\137\111\x50", "\x48\x54\124\120\x5f\x46\x4f\x52\127\x41\122\x44\x45\x44\x5f\106\117\122", "\x48\124\124\120\137\106\x4f\x52\x57\x41\x52\x44\105\x44", "\122\105\x4d\117\x54\x45\137\101\x44\x44\122"]; goto cf006; cf006: foreach ($e9477 as $Da890) { goto A77fe; A0aea: $e3f5a = trim($e9bdd[0]); goto Cafd8; A77fe: if (empty($_SERVER[$Da890])) { goto B2e08; } goto Ee50a; Ee50a: $e9bdd = explode("\x2c", $_SERVER[$Da890]); goto A0aea; E55c9: return $e3f5a; goto B8817; Cafd8: if (!filter_var($e3f5a, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) { goto f01a0; } goto E55c9; bcc7b: B2e08: goto ec116; B8817: f01a0: goto bcc7b; ec116: Ed181: goto Bc7e6; Bc7e6: } goto D264b; D264b: f5e0a: goto A0fc7; A0fc7: return $_SERVER["\x52\x45\x4d\117\x54\105\137\101\x44\x44\122"] ?? "\61\x32\67\56\x30\56\x30\56\x31"; goto C90e1; C90e1: } private function startSession() { goto f56f4; f56f4: if ($this->loadSessionByFingerprint()) { goto Aa4d2; } goto ad1fe; e70c4: c55bb: goto a632c; Ba3b2: $this->cleanupExpiredSessions(); goto e70c4; Dd3da: Aa4d2: goto Ffe9b; ad1fe: $this->createNewSession(); goto Dd3da; Ffe9b: if (!(rand(1, 100) === 1)) { goto c55bb; } goto Ba3b2; a632c: } private function createNewSession() { goto Cf2a9; C28f3: $this->b1dbb = array(); goto b9558; b9558: $C233a = date("\x59\55\155\55\144\x20\x48\72\x69\x3a\x73", time() + $this->Da5fc); goto fed71; fed71: try { goto F9a4c; A96d0: $E1918 = $this->F82cb->prepare("\xa\40\x20\40\40\x20\40\40\40\x20\40\x20\x20\40\x20\40\40\x49\116\x53\105\x52\124\x20\x49\x4e\x54\117\x20\163\145\163\x73\151\157\156\163\40\x28\x73\145\x73\163\x69\x6f\x6e\x5f\151\x64\x2c\x20\x63\154\x69\145\x6e\x74\x5f\146\151\156\147\145\x72\160\x72\x69\x6e\164\x2c\40\151\x70\137\141\144\x64\x72\x65\x73\163\x2c\40\165\x73\x65\x72\137\x61\147\145\x6e\164\x2c\40\145\170\160\151\162\145\x73\137\x61\x74\x29\40\12\40\x20\40\40\40\x20\x20\40\x20\x20\x20\40\40\x20\x20\40\126\x41\114\125\105\123\x20\50\x3f\x2c\40\x3f\54\40\x3f\x2c\40\77\x2c\x20\77\x29\12\x20\x20\x20\40\40\40\x20\40\x20\40\40\40"); goto F12f7; F12f7: $E1918->execute([$this->c6b60, $this->ec875, $this->getClientIP(), $_SERVER["\110\x54\124\x50\x5f\x55\123\x45\122\137\101\107\x45\x4e\124"] ?? "\x75\156\153\x6e\x6f\167\156", $C233a]); goto F5d27; F9a4c: $this->cleanupFingerprintSessions(); goto A96d0; F5d27: } catch (PDOException $fabfb) { throw new Exception("\106\141\x69\x6c\x65\x64\x20\164\x6f\x20\143\162\145\x61\x74\x65\40\163\x65\x73\163\151\x6f\x6e\72\40" . $fabfb->getMessage()); } goto e0b17; Cf2a9: $this->c6b60 = $this->generateSessionId(); goto C28f3; e0b17: } private function loadSessionByFingerprint() { try { goto E2c72; bbe42: $Ed8ec = date("\131\x2d\x6d\55\x64\40\x48\72\151\72\x73", time() + $this->Da5fc); goto eeafc; c8851: $D909a = $E1918->fetch(PDO::FETCH_ASSOC); goto f0876; Bae93: $a999d->execute([$Ed8ec, $this->c6b60]); goto c264b; b83a4: return false; goto F8e47; A9ada: $this->b1dbb = json_decode($D909a["\x73\145\x73\163\x69\x6f\x6e\x5f\144\141\164\141"], true) ?: array(); goto bbe42; f0876: if (!$D909a) { goto D83f6; } goto d6b8f; eeafc: $a999d = $this->F82cb->prepare("\xa\40\40\40\40\40\x20\x20\40\x20\x20\40\x20\x20\x20\x20\40\40\x20\x20\40\125\x50\104\101\x54\x45\40\x73\145\x73\163\x69\157\x6e\x73\40\x53\x45\124\x20\165\160\144\x61\164\145\144\x5f\141\x74\x20\75\x20\103\125\122\x52\105\x4e\124\137\x54\x49\x4d\x45\123\x54\101\115\x50\54\x20\145\x78\x70\x69\162\145\163\137\x61\x74\40\75\x20\77\x20\12\x20\x20\x20\x20\40\x20\x20\40\x20\40\40\40\x20\40\40\x20\40\40\40\x20\127\110\105\x52\105\40\163\x65\163\163\x69\x6f\x6e\137\x69\x64\40\x3d\40\x3f\xa\x20\40\40\x20\40\x20\40\x20\x20\40\40\40\40\x20\x20\40"); goto Bae93; d6b8f: $this->c6b60 = $D909a["\163\145\163\x73\151\x6f\156\x5f\151\144"]; goto A9ada; c264b: return true; goto E9350; E2c72: $E1918 = $this->F82cb->prepare("\xa\40\x20\x20\x20\x20\x20\40\40\x20\40\40\x20\x20\40\x20\40\x53\105\114\x45\103\124\x20\52\40\x46\x52\x4f\115\40\163\145\163\x73\151\157\156\x73\40\xa\x20\40\x20\x20\x20\40\40\40\40\40\40\40\40\40\x20\40\x57\x48\105\x52\105\40\143\x6c\x69\145\x6e\x74\137\x66\x69\x6e\x67\145\162\160\x72\x69\156\164\x20\x3d\40\x3f\x20\x41\x4e\x44\40\145\170\x70\151\x72\x65\163\x5f\x61\x74\40\x3e\x20\103\125\x52\x52\105\116\x54\x5f\x54\111\x4d\x45\123\x54\x41\115\x50\xa\40\40\x20\x20\40\x20\40\40\x20\x20\40\40\x20\40\40\x20\x4f\x52\x44\105\122\x20\102\131\x20\x75\160\144\x61\x74\145\x64\x5f\x61\x74\40\104\105\x53\x43\x20\114\x49\115\x49\x54\40\x31\12\40\40\x20\40\x20\x20\40\40\x20\40\x20\x20"); goto a741c; E9350: D83f6: goto b83a4; a741c: $E1918->execute([$this->ec875]); goto c8851; F8e47: } catch (PDOException $fabfb) { return false; } } private function cleanupFingerprintSessions() { try { $E1918 = $this->F82cb->prepare("\104\105\114\105\x54\105\40\x46\122\x4f\x4d\40\x73\145\163\163\151\x6f\156\x73\40\127\x48\105\122\105\40\143\x6c\151\145\x6e\164\x5f\x66\x69\156\147\x65\162\x70\162\151\156\164\40\x3d\x20\77"); $E1918->execute([$this->ec875]); } catch (PDOException $fabfb) { } } private function generateSessionId() { return hash("\163\x68\141\x32\65\x36", uniqid("\x73\145\163\163\137", true) . microtime(true) . $this->ec875 . rand(1000, 9999)); } private function setCookie() { } public function set($Da890, $F1899) { $this->b1dbb[$Da890] = $F1899; $this->saveSessionData(); } public function get($Da890, $b1f59 = null) { return isset($this->b1dbb[$Da890]) ? $this->b1dbb[$Da890] : $b1f59; } public function has($Da890) { return isset($this->b1dbb[$Da890]); } public function remove($Da890) { unset($this->b1dbb[$Da890]); $this->saveSessionData(); } public function getAll() { return $this->b1dbb; } public function clear() { $this->b1dbb = array(); $this->saveSessionData(); } private function saveSessionData() { try { $E1918 = $this->F82cb->prepare("\xa\x20\40\x20\x20\x20\40\40\40\40\x20\x20\40\40\x20\x20\40\125\x50\x44\x41\124\105\40\x73\x65\163\x73\x69\157\156\x73\x20\123\105\124\x20\163\145\x73\x73\151\x6f\x6e\x5f\x64\x61\164\141\40\75\x20\77\54\x20\165\160\x64\x61\x74\x65\x64\x5f\x61\164\x20\x3d\x20\103\x55\x52\x52\105\x4e\x54\x5f\124\x49\115\x45\x53\x54\101\115\120\x20\xa\x20\40\x20\x20\x20\x20\x20\40\x20\x20\40\40\40\x20\x20\40\x57\110\105\x52\x45\40\x73\145\x73\163\x69\x6f\x6e\x5f\x69\144\x20\x3d\40\77\xa\40\x20\40\40\40\40\x20\40\x20\40\40\x20"); $E1918->execute([json_encode($this->b1dbb), $this->c6b60]); } catch (PDOException $fabfb) { throw new Exception("\106\141\151\154\145\144\40\164\x6f\x20\x73\141\x76\145\40\163\x65\163\x73\x69\x6f\x6e\x20\x64\141\164\141\x3a\40" . $fabfb->getMessage()); } } public function destroy() { try { goto E5324; E5324: $E1918 = $this->F82cb->prepare("\x44\105\114\x45\x54\105\40\x46\x52\x4f\x4d\40\163\x65\x73\163\151\157\x6e\163\40\x57\110\105\x52\105\x20\x63\x6c\x69\145\156\164\137\x66\151\x6e\x67\145\x72\160\x72\151\156\164\x20\75\x20\77"); goto d8da6; d8da6: $E1918->execute([$this->ec875]); goto d7593; d4127: $this->c6b60 = null; goto C941c; d7593: $this->b1dbb = array(); goto d4127; C941c: } catch (PDOException $fabfb) { throw new Exception("\106\x61\x69\x6c\x65\144\40\x74\157\x20\x64\145\x73\x74\162\x6f\171\40\163\x65\x73\x73\151\x6f\156\x3a\40" . $fabfb->getMessage()); } } public function cleanupExpiredSessions() { try { $E1918 = $this->F82cb->prepare("\104\105\x4c\x45\124\x45\x20\106\x52\117\x4d\40\163\x65\x73\163\x69\157\x6e\163\x20\x57\110\105\122\x45\40\x65\170\160\x69\x72\x65\x73\137\x61\x74\40\x3c\40\103\125\122\122\x45\x4e\x54\137\124\111\x4d\x45\x53\124\101\x4d\x50"); $E1918->execute(); } catch (PDOException $fabfb) { } } public function getId() { return $this->c6b60; } public function getFingerprint() { return $this->ec875; } public function getSessionInfo() { goto Dbc0a; Dbc0a: if ($this->c6b60) { goto b42fb; } goto c8a7b; b6a51: b42fb: goto Acfa6; Acfa6: try { goto a639b; a639b: $E1918 = $this->F82cb->prepare("\x53\105\114\105\103\x54\x20\52\40\x46\x52\x4f\x4d\x20\163\145\163\x73\x69\x6f\156\x73\x20\x57\x48\x45\x52\x45\40\x73\145\163\163\151\157\156\137\x69\x64\x20\x3d\x20\x3f"); goto Da5b2; Da1a6: return $E1918->fetch(PDO::FETCH_ASSOC); goto a45f5; Da5b2: $E1918->execute([$this->c6b60]); goto Da1a6; a45f5: } catch (PDOException $fabfb) { return null; } goto E0c1d; c8a7b: return null; goto b6a51; E0c1d: } public function setSessionLifetime($dcb7a) { $this->Da5fc = max($dcb7a, 600); } public function getSessionLifetime() { return $this->Da5fc; } public function regenerateId() { goto Eaf60; c2458: $this->c6b60 = $this->generateSessionId(); goto E1082; Eaf60: $c795a = $this->c6b60; goto c2458; E1082: try { $E1918 = $this->F82cb->prepare("\12\x20\x20\x20\40\x20\40\40\40\40\40\x20\x20\40\x20\x20\40\125\120\x44\x41\x54\x45\x20\x73\145\x73\x73\151\x6f\156\163\x20\123\105\124\x20\x73\x65\x73\163\x69\157\156\137\x69\x64\40\75\40\x3f\54\x20\165\x70\x64\x61\164\x65\144\137\141\x74\40\75\40\103\x55\122\122\x45\x4e\124\x5f\124\x49\115\105\123\x54\101\115\x50\x20\xa\40\x20\x20\40\x20\40\x20\40\x20\40\40\x20\x20\x20\x20\40\127\x48\x45\x52\x45\x20\163\145\x73\163\151\157\x6e\x5f\151\x64\x20\x3d\40\77\12\40\x20\x20\x20\x20\40\x20\x20\40\40\40\x20"); $E1918->execute([$this->c6b60, $c795a]); } catch (PDOException $fabfb) { throw new Exception("\x46\141\151\x6c\145\x64\40\x74\x6f\40\x72\145\147\145\x6e\x65\162\x61\164\145\x20\163\145\x73\x73\x69\157\156\x20\x49\x44\72\x20" . $fabfb->getMessage()); } goto fd70e; fd70e: } public function isValid() { return !empty($this->c6b60) && $this->loadSessionByFingerprint(); } public function __get($Da890) { return $this->get($Da890); } public function __set($Da890, $F1899) { $this->set($Da890, $F1899); } public function __isset($Da890) { return $this->has($Da890); } public function __unset($Da890) { $this->remove($Da890); } } function B5719() { goto c9fb1; ebf51: if (!($D909a === null)) { goto ac86f; } goto D4117; dfb2a: ac86f: goto b16b7; c9fb1: static $D909a = null; goto ebf51; b16b7: return $D909a; goto c4870; D4117: $D909a = new CustomSession(); goto dfb2a; c4870: }
